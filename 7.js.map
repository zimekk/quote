{"version":3,"file":"7.js","mappings":"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","sources":["webpack://@dev/web/./src/containers/Quote/Chart.module.scss?fde6","webpack://@dev/web/./src/containers/Quote/Chart.tsx","webpack://@dev/web/./src/containers/Quote/styles.module.scss?d00d","webpack://@dev/web/./src/containers/Quote/index.tsx","webpack://@dev/web/./src/containers/Quote/Chart.module.scss","webpack://@dev/web/./src/containers/Quote/styles.module.scss"],"sourcesContent":["\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./Chart.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./Chart.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { axisBottom, axisLeft, select, scaleLinear, timeFormat } from \"d3\";\nimport { Subject, of } from \"rxjs\";\nimport { delay, switchMap } from \"rxjs/operators\";\nimport cx from \"classnames\";\nimport styles from \"./Chart.module.scss\";\n\nconst { width, height, left, right, top, bottom } = {\n  width: 320,\n  height: 200,\n  left: 10,\n  right: 10,\n  top: 20,\n  bottom: 20,\n};\n\nexport default function Chart({ list }: { list: any[] }) {\n  const [selected, setSelected] = useState<{\n    top: number;\n    left: number;\n    label: string;\n  } | null>(null);\n  const xAxisRef = useRef(null);\n  const yAxisRef = useRef(null);\n  const containerRef = useRef(null);\n\n  const selected$ = useMemo(\n    () => new Subject<{ left: number; top: number; label: string }>(),\n    []\n  );\n  useEffect(() => {\n    const subscription = selected$\n      .pipe(\n        switchMap((selected) => of(selected).pipe(delay(selected ? 0 : 800)))\n      )\n      .subscribe((selected) => setSelected(selected));\n\n    return () => subscription.unsubscribe();\n  }, [selected$]);\n\n  useEffect(() => {\n    const dataset = list.map((item) => [\n      new Date(item.price_timestamp),\n      item.price,\n      item.id,\n    ]);\n\n    const xx = dataset.map(([x = 0]) => x);\n    const yy = dataset.map(([, y = 0]) => y);\n\n    const xDomain = [Math.min(...xx), Math.max(...xx)];\n    const yDomain = [Math.min(...yy), Math.max(...yy)];\n\n    const xScale = scaleLinear()\n      .domain(xDomain)\n      .range([left, width - right]);\n\n    const yScale = scaleLinear()\n      .domain(yDomain)\n      .range([height - bottom, top]);\n\n    const color = scaleLinear().domain(yDomain).range([\"red\", \"blue\"]);\n\n    select(containerRef.current).selectAll(\"circle\").remove();\n    select(containerRef.current)\n      .selectAll(\"circle\")\n      .data(dataset)\n      .join(\n        (enter) =>\n          enter\n            .append(\"circle\")\n            .attr(\"cx\", ([x = 0]) => xScale(x))\n            .attr(\"cy\", ([, y = 0]) => yScale(y))\n            .attr(\"r\", 0)\n            .attr(\"fill\", ([x = 0]) => color(x))\n            .on(\"mouseover\", (e, [, , label]) =>\n              selected$.next({ left: e.layerX, top: e.layerY, label })\n            )\n            .on(\"mouseout\", () => selected$.next(null))\n            .call((enter) =>\n              enter.transition().duration(200).attr(\"r\", 2).style(\"opacity\", 1)\n            ),\n        (update) => update.attr(\"fill\", \"lightgrey\"),\n        (exit) =>\n          exit\n            .attr(\"fill\", \"tomato\")\n            .call((exit) =>\n              exit\n                .transition()\n                .duration(200)\n                .attr(\"r\", 0)\n                .style(\"opacity\", 0)\n                .remove()\n            )\n      );\n\n    const xAxis = axisBottom(xScale)\n      .ticks(5)\n      .tickSizeOuter(0)\n      .tickFormat(timeFormat(\"%Y-%m-%d, %H:%M:%S\"));\n    select(xAxisRef.current).call(xAxis).style(\"font-size\", \"8px\");\n\n    const yAxis = axisLeft(yScale).ticks(5).tickSizeOuter(0);\n    select(yAxisRef.current).call(yAxis).style(\"font-size\", \"8px\");\n  }, [list]);\n\n  return (\n    <div className={cx(styles.Chart)}>\n      <svg\n        ref={containerRef}\n        width={width}\n        height={height}\n        viewBox={`0, 0, ${width}, ${height}`}\n      >\n        <g transform={`translate(0, ${height - bottom})`} ref={xAxisRef} />\n        <g transform={`translate(${left}, 0)`} ref={yAxisRef} />\n      </svg>\n      {selected && (\n        <div\n          className={styles.Tooltip}\n          style={{ top: selected.top, left: selected.left }}\n        >\n          {selected.label}\n        </div>\n      )}\n    </div>\n  );\n}\n","\n      import API from \"!../../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../../node_modules/css-loader/dist/cjs.js!../../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[0].use[2]!./styles.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import React, { useMemo } from \"react\";\nimport { createAsset } from \"use-asset\";\nimport Chart from \"./Chart\";\nimport styles from \"./styles.module.scss\";\n\nconst asset = createAsset(async () => {\n  const res = await fetch(`api/quote.json`);\n  return await res.json();\n});\n\nfunction Rates({ symbol, rates }) {\n  const [{ logo_url }] = rates;\n\n  return (\n    <div>\n      <h3>\n        <img alt={symbol} src={logo_url} />\n        <span>{symbol}</span>\n      </h3>\n      <Chart list={rates} />\n    </div>\n  );\n}\n\nexport default function Section() {\n  const { results } = asset.read();\n\n  const list = useMemo(\n    () =>\n      results.reduce(\n        (result, item) =>\n          Object.assign(result, {\n            [item.symbol]: (result[item.symbol] || []).concat(item),\n          }),\n        {}\n      ),\n    [results]\n  );\n\n  console.log({ list });\n\n  return (\n    <section className={styles.Section}>\n      <h2>Quote</h2>\n      {Object.entries(list).map(([symbol, rates]) => (\n        <Rates key={symbol} symbol={symbol} rates={rates} />\n      ))}\n      <pre>{JSON.stringify(results, null, 2)}</pre>\n    </section>\n  );\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".GD1VOmHbAdLdAEhpcP76{position:relative;border:2px solid red}.GD1VOmHbAdLdAEhpcP76 svg{width:100%;height:50vh}.GD1VOmHbAdLdAEhpcP76 .rUOrYdAmIEQZil4CemrZ{position:absolute}.rUOrYdAmIEQZil4CemrZ{background:#fff;border:1px solid #add8e6;color:orange;padding:.25em}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/containers/Quote/Chart.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,iBAAA,CACA,oBAAA,CAEA,0BACE,UAAA,CACA,WAAA,CAEF,4CACE,iBAAA,CAGJ,sBACE,eAAA,CACA,wBAAA,CACA,YAAA,CACA,aAAA\",\"sourcesContent\":[\".Chart {\\n  position: relative;\\n  border: 2px solid red;\\n\\n  svg {\\n    width: 100%;\\n    height: 50vh;\\n  }\\n  .Tooltip {\\n    position: absolute;\\n  }\\n}\\n.Tooltip {\\n  background: white;\\n  border: 1px solid lightblue;\\n  color: orange;\\n  padding: 0.25em;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Chart\": \"GD1VOmHbAdLdAEhpcP76\",\n\t\"Tooltip\": \"rUOrYdAmIEQZil4CemrZ\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".nIFFESrZohc36HDUpxy2{color:blue}.nIFFESrZohc36HDUpxy2 h3 img{width:24px;height:24px}.nIFFESrZohc36HDUpxy2 h3 img+span{margin-left:1em}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/containers/Quote/styles.module.scss\"],\"names\":[],\"mappings\":\"AAAA,sBACE,UAAA,CAGE,6BACE,UAAA,CACA,WAAA,CACA,kCACE,eAAA\",\"sourcesContent\":[\".Section {\\n  color: blue;\\n\\n  h3 {\\n    img {\\n      width: 24px;\\n      height: 24px;\\n      & + span {\\n        margin-left: 1em;\\n      }\\n    }\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"Section\": \"nIFFESrZohc36HDUpxy2\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","undefined","width","height","left","right","top","bottom","Chart","list","selected","setSelected","useState","xAxisRef","useRef","yAxisRef","containerRef","selected$","useMemo","Subject","useEffect","subscription","pipe","switchMap","of","delay","subscribe","unsubscribe","dataset","map","item","Date","price_timestamp","price","id","xx","x","yy","y","xDomain","Math","min","max","yDomain","xScale","scaleLinear","domain","range","yScale","color","select","current","selectAll","remove","data","join","enter","append","attr","on","e","label","next","layerX","layerY","call","transition","duration","style","update","exit","xAxis","axisBottom","ticks","tickSizeOuter","tickFormat","timeFormat","yAxis","axisLeft","className","cx","styles","ref","viewBox","transform","asset","createAsset","async","res","fetch","json","Rates","symbol","rates","logo_url","alt","src","Section","results","read","reduce","result","Object","assign","concat","console","log","entries","key","JSON","stringify","___CSS_LOADER_EXPORT___","push","module","locals"],"sourceRoot":""}